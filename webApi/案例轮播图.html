<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>案例轮播图</title>
	<style>
		* {
			padding: 0;
			margin: 0;
			list-style: none;
			border: 0;
		}
		.all {
			width: 500px;
			height: 200px;
			padding: 7px;
			border: 1px solid #ccc;
			margin: 100px auto;
			position: relative;
		}
		.screen {
			width: 500px;
			height: 200px;
			position: relative;
			overflow: hidden;
		}
		.screen ul {
			position: absolute;
			left: 0;
			top: 0;
			width: 3000px;
		}
		.screen li {
			width: 500px;
			height: 200px;
			float: left;
			overflow: hidden;
		}
		.all ol {
			position: absolute;
			right: 10px;
			bottom: 10px;
			text-align: center;
			line-height: 20px;
		}
		.all ol li {
			float: left;
			width: 20px;
			height: 20px;
			background-color: #fff;
			border: 1px solid #ccc;
			margin-left: 10px;
			cursor: pointer;
		}
		.all ol li.current {
			background: #DB192A;
		}
		#arr {
			display: none;
		}
		#arr span {
			width: 40px;
			height: 40px;
			left: 5px;
			top: 50%;
			margin-top: -20px;
			background: #000;
			cursor: pointer;
			font: bold 30px/40px 'SimHei';
			text-align: center;
			color: #fff;
			opacity: 0.3;
			border: 1px solid #fff;
			position: absolute;
		}
		#arr #right {
			right: 5px;
			left: auto;
		}
	</style>
</head>
<body>
	<div class="all" id="box">
		<div class="screen">
			<ul>
				<li><img src="imgs/1.jpg" width="500" height="200"></li>
				<li><img src="imgs/2.jpg" width="500" height="200"></li>
				<li><img src="imgs/3.jpg" width="500" height="200"></li>
				<li><img src="imgs/4.jpg" width="500" height="200"></li>
				<li><img src="imgs/5.jpg" width="500" height="200"></li>
			</ul>
			<ol>
				
			</ol>
		</div>
		<div id="arr"><span id='left'>&lt;</span><span id='right'>&gt;</span></div>
	</div>
	<script src="common.js"></script>
	<script>
		function animate(element, target) {
			//清理定时器
			clearInterval(element.timeId);
			element.timeId = setInterval(function(){
				//当前位置
				var current = element.offsetLeft;
				//每次移动的步数
				var step = 10;
				//移动的是正数还是负数
				step = current<target?step:-step;
				//移动后的当前位置计算
				current += step;
				//判断是否移动
				if(Math.abs(target-current)>Math.abs(step)){
					element.style.left = current+"px";
				}else{
					//直接到达目标
					element.style.left = target+'px';
					//清理定时器
					clearInterval(element.timeId);
				}
			}, 10);
		}


		//获取所有需要的元素
  		//最外面的div
  		var box = my$('box');
  		//获取相框
  		var screen = box.children[0];
		//相框的宽度
		var imgWidth = screen.offsetWidth;
		//获取ul
		var ulObj = screen.children[0];
		//获取ul中所有的li
		var list = ulObj.children;
		//获取ol
		var olObj = screen.children[1];
		//左右焦点的div
		var arr = my$("arr");
		//左按钮
		var left = my$("left");
		//右按钮
		var right = my$("right");

		var pic = 0;
		for (var i = 0; i < list.length; i++) {
			var liObj = document.createElement("li");
			liObj.innerHTML = (i + 1);
			//添加自定义属性存储索引的值
			liObj.setAttribute("index", i);
			olObj.appendChild(liObj);
			liObj.onmouseover = function () {
				for(var j=0; j<olObj.children.length; j++){
					olObj.children[j].removeAttribute("class");
				}
				this.className="current";
				pic = this.getAttribute("index");
				animate(ulObj, -pic*imgWidth);
			};
		}
		olObj.children[0].className="current";
		ulObj.appendChild(ulObj.children[0].cloneNode(true));

		//自动移动
		var timeId=setInterval(clickHandle, 1000);
		//鼠标进入最外面的box显示左右焦点的div
		box.onmouseover=function() {
			arr.style.display = 'block';
			clearInterval(timeId);
		};
		//鼠标离开最外面的box隐藏左右焦点的div
		box.onmouseout=function(){
			arr.style.display = 'none';
			timeId=setInterval(clickHandle, 1000);
		};
		//right按钮点击
		pic = 0;
		function clickHandle() {
			if(pic==list.length-1){
				//如果pic的索引值和ul中的所有的li的个数减1一样---5
      			//显示的是第6张图(实际上用户会认为是第1个,再点击按钮,用户应该看到第2个图)
				pic=0;//索引为0
				ulObj.style.left = -pic*imgWidth+"px";
			}
			pic++;
			animate(ulObj, -pic*imgWidth);//移动到了第二个图了

			//pic最大的值是5
			if(pic==list.length-1){
				//ol中第一个li有类样式
				olObj.children[0].className="current";
				//ol中最后一个li去掉类演示
				olObj.lastChild.removeAttribute("class");
				// olObj.children[olObj.children.length-1].className="";
			}else{
				//把ol中所有的li的类样式全部干掉
				for (var i = 0; i < olObj.children.length; i++) {
					olObj.children[i].removeAttribute("class");
				}
				olObj.children[pic].className="current";
			}
		}
		right.onclick=clickHandle;

		//left按钮点击
		left.onclick=function(){
			if(pic==0){
				pic=list.length-1;
				ulObj.style.left=-pic*imgWidth+"px";
			}
			pic--;
			animate(ulObj,-pic*imgWidth);
			for (var i = 0; i < olObj.children.length; i++) {
				olObj.children[i].removeAttribute("class");
			}
			olObj.children[pic].className="current";
		};
	</script>
</body>
</html>